{"version":3,"sources":["file:///Users/longbow/node_modules/rc-virtual-list/lib/hooks/useScrollTo.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","url","define","exports","require","module","__filename","__dirname","_interopRequireWildcard","default","_interopRequireDefault","Object","defineProperty","value","useScrollTo","_typeof2","React","_raf","containerRef","data","heights","itemHeight","getKey","collectHeight","syncScrollTop","triggerFlash","scrollRef","useRef","arg","undefined","cancel","current","index","align","findIndex","item","key","_arg$offset","offset","syncScroll","times","targetAlign","height","clientHeight","needCollectHeight","newTargetAlign","mergedAlign","stackTop","itemTop","itemBottom","maxLen","Math","min","length","i","cacheHeight","get","targetTop","scrollTop","scrollBottom","_cjsExports","___esModule","__esModule","_default"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireWildcard';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req1} from '@babel/runtime/helpers/typeof';\nimport { __cjsMetaURL as _req2} from 'react';\nimport { __cjsMetaURL as _req3} from 'rc-util/lib/raf';\nlet _cjsExports;\nlet ___esModule;\nlet _default;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = useScrollTo;\n var _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n var React = _interopRequireWildcard(require(\"react\"));\n var _raf = _interopRequireDefault(require(\"rc-util/lib/raf\"));\n /* eslint-disable no-param-reassign */\n\n function useScrollTo(containerRef, data, heights, itemHeight, getKey, collectHeight, syncScrollTop, triggerFlash) {\n   var scrollRef = React.useRef();\n   return function (arg) {\n     // When not argument provided, we think dev may want to show the scrollbar\n     if (arg === null || arg === undefined) {\n       triggerFlash();\n       return;\n     }\n     // Normal scroll logic\n     _raf.default.cancel(scrollRef.current);\n     if (typeof arg === 'number') {\n       syncScrollTop(arg);\n     } else if (arg && (0, _typeof2.default)(arg) === 'object') {\n       var index;\n       var align = arg.align;\n       if ('index' in arg) {\n         index = arg.index;\n       } else {\n         index = data.findIndex(function (item) {\n           return getKey(item) === arg.key;\n         });\n       }\n       var _arg$offset = arg.offset,\n         offset = _arg$offset === void 0 ? 0 : _arg$offset;\n       // We will retry 3 times in case dynamic height shaking\n       var syncScroll = function syncScroll(times, targetAlign) {\n         if (times < 0 || !containerRef.current) return;\n         var height = containerRef.current.clientHeight;\n         var needCollectHeight = false;\n         var newTargetAlign = targetAlign;\n         // Go to next frame if height not exist\n         if (height) {\n           var mergedAlign = targetAlign || align;\n           // Get top & bottom\n           var stackTop = 0;\n           var itemTop = 0;\n           var itemBottom = 0;\n           var maxLen = Math.min(data.length, index);\n           for (var i = 0; i <= maxLen; i += 1) {\n             var key = getKey(data[i]);\n             itemTop = stackTop;\n             var cacheHeight = heights.get(key);\n             itemBottom = itemTop + (cacheHeight === undefined ? itemHeight : cacheHeight);\n             stackTop = itemBottom;\n             if (i === index && cacheHeight === undefined) {\n               needCollectHeight = true;\n             }\n           }\n           // Scroll to\n           var targetTop = null;\n           switch (mergedAlign) {\n             case 'top':\n               targetTop = itemTop - offset;\n               break;\n             case 'bottom':\n               targetTop = itemBottom - height + offset;\n               break;\n             default:\n               {\n                 var scrollTop = containerRef.current.scrollTop;\n                 var scrollBottom = scrollTop + height;\n                 if (itemTop < scrollTop) {\n                   newTargetAlign = 'top';\n                 } else if (itemBottom > scrollBottom) {\n                   newTargetAlign = 'bottom';\n                 }\n               }\n           }\n           if (targetTop !== null && targetTop !== containerRef.current.scrollTop) {\n             syncScrollTop(targetTop);\n           }\n         }\n         // We will retry since element may not sync height as it described\n         scrollRef.current = (0, _raf.default)(function () {\n           if (needCollectHeight) {\n             collectHeight();\n           }\n           syncScroll(times - 1, newTargetAlign);\n         }, 2); // Delay 2 to wait for List collect heights\n       };\n\n       syncScroll(3);\n     }\n   };\n }\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default = module.exports.default;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireWildcard': _req,\n  '@babel/runtime/helpers/interopRequireDefault': _req0,\n  '@babel/runtime/helpers/typeof': _req1,\n  'react': _req2,\n  'rc-util/lib/raf': _req3,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}