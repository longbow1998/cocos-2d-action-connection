{"version":3,"sources":["file:///Users/longbow/node_modules/rc-resize-observer/lib/SingleObserver/index.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","_req6","_req7","url","define","exports","require","module","__filename","__dirname","_interopRequireWildcard","default","_interopRequireDefault","Object","defineProperty","value","_objectSpread2","_ref","React","_findDOMNode","_observerUtil","_DomWrapper","_Collection","SingleObserver","props","ref","children","disabled","elementRef","useRef","wrapperRef","onCollectionResize","useContext","CollectionContext","isRenderProps","mergedChildren","sizeRef","width","height","offsetWidth","offsetHeight","canRef","isValidElement","supportRef","originRef","mergedRef","useMemo","composeRef","getDom","current","useImperativeHandle","propsRef","onInternalResize","useCallback","target","_propsRef$current","onResize","data","_target$getBoundingCl","getBoundingClientRect","fixedWidth","Math","floor","fixedHeight","size","mergedOffsetWidth","round","mergedOffsetHeight","sizeInfo","Promise","resolve","then","useEffect","currentElement","observe","unobserve","createElement","cloneElement","RefSingleObserver","forwardRef","process","env","NODE_ENV","displayName","_default","_cjsExports","___esModule","__esModule","_default0"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireWildcard';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req1} from '@babel/runtime/helpers/objectSpread2';\nimport { __cjsMetaURL as _req2} from 'rc-util/lib/ref';\nimport { __cjsMetaURL as _req3} from 'react';\nimport { __cjsMetaURL as _req4} from 'rc-util/lib/Dom/findDOMNode';\nimport { __cjsMetaURL as _req5} from '../utils/observerUtil';\nimport { __cjsMetaURL as _req6} from './DomWrapper';\nimport { __cjsMetaURL as _req7} from '../Collection';\nlet _cjsExports;\nlet ___esModule;\nlet _default0;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = void 0;\n var _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread2\"));\n var _ref = require(\"rc-util/lib/ref\");\n var React = _interopRequireWildcard(require(\"react\"));\n var _findDOMNode = _interopRequireDefault(require(\"rc-util/lib/Dom/findDOMNode\"));\n var _observerUtil = require(\"../utils/observerUtil\");\n var _DomWrapper = _interopRequireDefault(require(\"./DomWrapper\"));\n var _Collection = require(\"../Collection\");\n function SingleObserver(props, ref) {\n   var children = props.children,\n     disabled = props.disabled;\n   var elementRef = React.useRef(null);\n   var wrapperRef = React.useRef(null);\n   var onCollectionResize = React.useContext(_Collection.CollectionContext);\n   // =========================== Children ===========================\n   var isRenderProps = typeof children === 'function';\n   var mergedChildren = isRenderProps ? children(elementRef) : children;\n   // ============================= Size =============================\n   var sizeRef = React.useRef({\n     width: -1,\n     height: -1,\n     offsetWidth: -1,\n     offsetHeight: -1\n   });\n   // ============================= Ref ==============================\n   var canRef = !isRenderProps && /*#__PURE__*/React.isValidElement(mergedChildren) && (0, _ref.supportRef)(mergedChildren);\n   var originRef = canRef ? mergedChildren.ref : null;\n   var mergedRef = React.useMemo(function () {\n     return (0, _ref.composeRef)(originRef, elementRef);\n   }, [originRef, elementRef]);\n   var getDom = function getDom() {\n     return (0, _findDOMNode.default)(elementRef.current) || (0, _findDOMNode.default)(wrapperRef.current);\n   };\n   React.useImperativeHandle(ref, function () {\n     return getDom();\n   });\n   // =========================== Observe ============================\n   var propsRef = React.useRef(props);\n   propsRef.current = props;\n   // Handler\n   var onInternalResize = React.useCallback(function (target) {\n     var _propsRef$current = propsRef.current,\n       onResize = _propsRef$current.onResize,\n       data = _propsRef$current.data;\n     var _target$getBoundingCl = target.getBoundingClientRect(),\n       width = _target$getBoundingCl.width,\n       height = _target$getBoundingCl.height;\n     var offsetWidth = target.offsetWidth,\n       offsetHeight = target.offsetHeight;\n     /**\n      * Resize observer trigger when content size changed.\n      * In most case we just care about element size,\n      * let's use `boundary` instead of `contentRect` here to avoid shaking.\n      */\n     var fixedWidth = Math.floor(width);\n     var fixedHeight = Math.floor(height);\n     if (sizeRef.current.width !== fixedWidth || sizeRef.current.height !== fixedHeight || sizeRef.current.offsetWidth !== offsetWidth || sizeRef.current.offsetHeight !== offsetHeight) {\n       var size = {\n         width: fixedWidth,\n         height: fixedHeight,\n         offsetWidth: offsetWidth,\n         offsetHeight: offsetHeight\n       };\n       sizeRef.current = size;\n       // IE is strange, right?\n       var mergedOffsetWidth = offsetWidth === Math.round(width) ? width : offsetWidth;\n       var mergedOffsetHeight = offsetHeight === Math.round(height) ? height : offsetHeight;\n       var sizeInfo = (0, _objectSpread2.default)((0, _objectSpread2.default)({}, size), {}, {\n         offsetWidth: mergedOffsetWidth,\n         offsetHeight: mergedOffsetHeight\n       });\n       // Let collection know what happened\n       onCollectionResize === null || onCollectionResize === void 0 ? void 0 : onCollectionResize(sizeInfo, target, data);\n       if (onResize) {\n         // defer the callback but not defer to next frame\n         Promise.resolve().then(function () {\n           onResize(sizeInfo, target);\n         });\n       }\n     }\n   }, []);\n   // Dynamic observe\n   React.useEffect(function () {\n     var currentElement = getDom();\n     if (currentElement && !disabled) {\n       (0, _observerUtil.observe)(currentElement, onInternalResize);\n     }\n     return function () {\n       return (0, _observerUtil.unobserve)(currentElement, onInternalResize);\n     };\n   }, [elementRef.current, disabled]);\n   // ============================ Render ============================\n   return /*#__PURE__*/React.createElement(_DomWrapper.default, {\n     ref: wrapperRef\n   }, canRef ? /*#__PURE__*/React.cloneElement(mergedChildren, {\n     ref: mergedRef\n   }) : mergedChildren);\n }\n var RefSingleObserver = /*#__PURE__*/React.forwardRef(SingleObserver);\n if (process.env.NODE_ENV !== 'production') {\n   RefSingleObserver.displayName = 'SingleObserver';\n }\n var _default = RefSingleObserver;\n exports.default = _default;\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default0 = module.exports.default;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireWildcard': _req,\n  '@babel/runtime/helpers/interopRequireDefault': _req0,\n  '@babel/runtime/helpers/objectSpread2': _req1,\n  'rc-util/lib/ref': _req2,\n  'react': _req3,\n  'rc-util/lib/Dom/findDOMNode': _req4,\n  '../utils/observerUtil': _req5,\n  './DomWrapper': _req6,\n  '../Collection': _req7,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}