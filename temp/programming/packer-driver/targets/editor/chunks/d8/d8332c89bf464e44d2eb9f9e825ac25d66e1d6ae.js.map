{"version":3,"sources":["file:///Users/longbow/node_modules/@rc-component/portal/lib/useDom.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","_req6","url","define","exports","require","module","__filename","__dirname","_interopRequireWildcard","default","_interopRequireDefault","Object","defineProperty","value","useDom","_toConsumableArray2","_slicedToArray2","React","_useLayoutEffect","_canUseDom","_Context","EMPTY_LIST","render","debug","_React$useState","useState","defaultEle","document","createElement","process","env","NODE_ENV","setAttribute","_React$useState2","ele","appendedRef","useRef","queueCreate","useContext","_React$useState3","_React$useState4","queue","setQueue","mergedQueueCreate","current","undefined","appendFn","origin","newQueue","concat","append","parentElement","body","appendChild","cleanup","_ele$parentElement","removeChild","length","forEach","_cjsExports","___esModule","__esModule","_default"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireWildcard';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req1} from '@babel/runtime/helpers/toConsumableArray';\nimport { __cjsMetaURL as _req2} from '@babel/runtime/helpers/slicedToArray';\nimport { __cjsMetaURL as _req3} from 'react';\nimport { __cjsMetaURL as _req4} from 'rc-util/lib/hooks/useLayoutEffect';\nimport { __cjsMetaURL as _req5} from 'rc-util/lib/Dom/canUseDom';\nimport { __cjsMetaURL as _req6} from './Context';\nlet _cjsExports;\nlet ___esModule;\nlet _default;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = useDom;\n\n var _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\n var _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\n var React = _interopRequireWildcard(require(\"react\"));\n\n var _useLayoutEffect = _interopRequireDefault(require(\"rc-util/lib/hooks/useLayoutEffect\"));\n\n var _canUseDom = _interopRequireDefault(require(\"rc-util/lib/Dom/canUseDom\"));\n\n var _Context = _interopRequireDefault(require(\"./Context\"));\n\n var EMPTY_LIST = [];\n /**\n  * Will add `div` to document. Nest call will keep order\n  * @param render Render DOM in document\n  */\n\n function useDom(render, debug) {\n   var _React$useState = React.useState(function () {\n     if (!(0, _canUseDom.default)()) {\n       return null;\n     }\n\n     var defaultEle = document.createElement('div');\n\n     if (process.env.NODE_ENV !== 'production' && debug) {\n       defaultEle.setAttribute('data-debug', debug);\n     }\n\n     return defaultEle;\n   }),\n       _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 1),\n       ele = _React$useState2[0]; // ========================== Order ==========================\n\n\n   var appendedRef = React.useRef(false);\n   var queueCreate = React.useContext(_Context.default);\n\n   var _React$useState3 = React.useState(EMPTY_LIST),\n       _React$useState4 = (0, _slicedToArray2.default)(_React$useState3, 2),\n       queue = _React$useState4[0],\n       setQueue = _React$useState4[1];\n\n   var mergedQueueCreate = queueCreate || (appendedRef.current ? undefined : function (appendFn) {\n     setQueue(function (origin) {\n       var newQueue = [appendFn].concat((0, _toConsumableArray2.default)(origin));\n       return newQueue;\n     });\n   }); // =========================== DOM ===========================\n\n   function append() {\n     if (!ele.parentElement) {\n       document.body.appendChild(ele);\n     }\n\n     appendedRef.current = true;\n   }\n\n   function cleanup() {\n     var _ele$parentElement;\n\n     (_ele$parentElement = ele.parentElement) === null || _ele$parentElement === void 0 ? void 0 : _ele$parentElement.removeChild(ele);\n     appendedRef.current = false;\n   }\n\n   (0, _useLayoutEffect.default)(function () {\n     if (render) {\n       if (queueCreate) {\n         queueCreate(append);\n       } else {\n         append();\n       }\n     } else {\n       cleanup();\n     }\n\n     return cleanup;\n   }, [render]);\n   (0, _useLayoutEffect.default)(function () {\n     if (queue.length) {\n       queue.forEach(function (appendFn) {\n         return appendFn();\n       });\n       setQueue(EMPTY_LIST);\n     }\n   }, [queue]);\n   return [ele, mergedQueueCreate];\n }\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default = module.exports.default;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireWildcard': _req,\n  '@babel/runtime/helpers/interopRequireDefault': _req0,\n  '@babel/runtime/helpers/toConsumableArray': _req1,\n  '@babel/runtime/helpers/slicedToArray': _req2,\n  'react': _req3,\n  'rc-util/lib/hooks/useLayoutEffect': _req4,\n  'rc-util/lib/Dom/canUseDom': _req5,\n  './Context': _req6,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}