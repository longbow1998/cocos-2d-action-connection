{"version":3,"sources":["file:///Users/longbow/node_modules/rc-virtual-list/lib/hooks/useHeights.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","url","define","exports","require","module","__filename","__dirname","_interopRequireWildcard","default","_interopRequireDefault","Object","defineProperty","value","useHeights","_slicedToArray2","React","_findDOMNode","_raf","_CacheMap","getKey","onItemAdd","onItemRemove","_React$useState","useState","_React$useState2","updatedMark","setUpdatedMark","instanceRef","useRef","Map","heightsRef","collectRafRef","cancelRaf","cancel","current","collectHeight","forEach","element","key","offsetParent","htmlElement","offsetHeight","get","set","c","setInstanceRef","item","instance","origin","delete","useEffect","_cjsExports","___esModule","__esModule","_default"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireWildcard';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req1} from '@babel/runtime/helpers/slicedToArray';\nimport { __cjsMetaURL as _req2} from 'react';\nimport { __cjsMetaURL as _req3} from 'rc-util/lib/Dom/findDOMNode';\nimport { __cjsMetaURL as _req4} from 'rc-util/lib/raf';\nimport { __cjsMetaURL as _req5} from '../utils/CacheMap';\nlet _cjsExports;\nlet ___esModule;\nlet _default;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = useHeights;\n var _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n var React = _interopRequireWildcard(require(\"react\"));\n var _findDOMNode = _interopRequireDefault(require(\"rc-util/lib/Dom/findDOMNode\"));\n var _raf = _interopRequireDefault(require(\"rc-util/lib/raf\"));\n var _CacheMap = _interopRequireDefault(require(\"../utils/CacheMap\"));\n function useHeights(getKey, onItemAdd, onItemRemove) {\n   var _React$useState = React.useState(0),\n     _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),\n     updatedMark = _React$useState2[0],\n     setUpdatedMark = _React$useState2[1];\n   var instanceRef = (0, React.useRef)(new Map());\n   var heightsRef = (0, React.useRef)(new _CacheMap.default());\n   var collectRafRef = (0, React.useRef)();\n   function cancelRaf() {\n     _raf.default.cancel(collectRafRef.current);\n   }\n   function collectHeight() {\n     cancelRaf();\n     collectRafRef.current = (0, _raf.default)(function () {\n       instanceRef.current.forEach(function (element, key) {\n         if (element && element.offsetParent) {\n           var htmlElement = (0, _findDOMNode.default)(element);\n           var offsetHeight = htmlElement.offsetHeight;\n           if (heightsRef.current.get(key) !== offsetHeight) {\n             heightsRef.current.set(key, htmlElement.offsetHeight);\n           }\n         }\n       });\n       // Always trigger update mark to tell parent that should re-calculate heights when resized\n       setUpdatedMark(function (c) {\n         return c + 1;\n       });\n     });\n   }\n   function setInstanceRef(item, instance) {\n     var key = getKey(item);\n     var origin = instanceRef.current.get(key);\n     if (instance) {\n       instanceRef.current.set(key, instance);\n       collectHeight();\n     } else {\n       instanceRef.current.delete(key);\n     }\n     // Instance changed\n     if (!origin !== !instance) {\n       if (instance) {\n         onItemAdd === null || onItemAdd === void 0 ? void 0 : onItemAdd(item);\n       } else {\n         onItemRemove === null || onItemRemove === void 0 ? void 0 : onItemRemove(item);\n       }\n     }\n   }\n   (0, React.useEffect)(function () {\n     return cancelRaf;\n   }, []);\n   return [setInstanceRef, collectHeight, heightsRef.current, updatedMark];\n }\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default = module.exports.default;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireWildcard': _req,\n  '@babel/runtime/helpers/interopRequireDefault': _req0,\n  '@babel/runtime/helpers/slicedToArray': _req1,\n  'react': _req2,\n  'rc-util/lib/Dom/findDOMNode': _req3,\n  'rc-util/lib/raf': _req4,\n  '../utils/CacheMap': _req5,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}