{"version":3,"sources":["file:///Users/longbow/node_modules/antd/lib/upload/utils.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","url","define","exports","require","module","__filename","__dirname","_interopRequireDefault","Object","defineProperty","value","file2Obj","getFileItem","isImageUrl","previewImage","removeFileItem","updateFileList","_toConsumableArray2","_extends2","file","lastModified","lastModifiedDate","name","size","type","uid","percent","originFileObj","fileList","nextFileList","fileIndex","findIndex","_ref","push","matchKey","undefined","filter","item","removed","length","extname","arguments","temp","split","filename","filenameWithoutSuffix","exec","isImageFileType","indexOf","thumbUrl","extension","test","MEASURE_SIZE","Promise","resolve","canvas","document","createElement","width","height","style","cssText","concat","body","appendChild","ctx","getContext","img","Image","onload","drawWidth","drawHeight","offsetX","offsetY","drawImage","dataURL","toDataURL","removeChild","crossOrigin","startsWith","reader","FileReader","addEventListener","result","src","readAsDataURL","window","URL","createObjectURL","_cjsExports","___esModule","__esModule","_file2Obj","_getFileItem","_isImageUrl","_previewImage","_removeFileItem","_updateFileList"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/toConsumableArray';\nimport { __cjsMetaURL as _req1} from '@babel/runtime/helpers/extends';\nlet _cjsExports;\nlet ___esModule;\nlet _file2Obj;\nlet _getFileItem;\nlet _isImageUrl;\nlet _previewImage;\nlet _removeFileItem;\nlet _updateFileList;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\")[\"default\"];\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.file2Obj = file2Obj;\n exports.getFileItem = getFileItem;\n exports.isImageUrl = void 0;\n exports.previewImage = previewImage;\n exports.removeFileItem = removeFileItem;\n exports.updateFileList = updateFileList;\n var _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n var _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n function file2Obj(file) {\n   return (0, _extends2[\"default\"])((0, _extends2[\"default\"])({}, file), {\n     lastModified: file.lastModified,\n     lastModifiedDate: file.lastModifiedDate,\n     name: file.name,\n     size: file.size,\n     type: file.type,\n     uid: file.uid,\n     percent: 0,\n     originFileObj: file\n   });\n }\n /** Upload fileList. Replace file if exist or just push into it. */\n function updateFileList(file, fileList) {\n   var nextFileList = (0, _toConsumableArray2[\"default\"])(fileList);\n   var fileIndex = nextFileList.findIndex(function (_ref) {\n     var uid = _ref.uid;\n     return uid === file.uid;\n   });\n   if (fileIndex === -1) {\n     nextFileList.push(file);\n   } else {\n     nextFileList[fileIndex] = file;\n   }\n   return nextFileList;\n }\n function getFileItem(file, fileList) {\n   var matchKey = file.uid !== undefined ? 'uid' : 'name';\n   return fileList.filter(function (item) {\n     return item[matchKey] === file[matchKey];\n   })[0];\n }\n function removeFileItem(file, fileList) {\n   var matchKey = file.uid !== undefined ? 'uid' : 'name';\n   var removed = fileList.filter(function (item) {\n     return item[matchKey] !== file[matchKey];\n   });\n   if (removed.length === fileList.length) {\n     return null;\n   }\n   return removed;\n }\n // ==================== Default Image Preview ====================\n var extname = function extname() {\n   var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n   var temp = url.split('/');\n   var filename = temp[temp.length - 1];\n   var filenameWithoutSuffix = filename.split(/#|\\?/)[0];\n   return (/\\.[^./\\\\]*$/.exec(filenameWithoutSuffix) || [''])[0];\n };\n var isImageFileType = function isImageFileType(type) {\n   return type.indexOf('image/') === 0;\n };\n var isImageUrl = function isImageUrl(file) {\n   if (file.type && !file.thumbUrl) {\n     return isImageFileType(file.type);\n   }\n   var url = file.thumbUrl || file.url || '';\n   var extension = extname(url);\n   if (/^data:image\\//.test(url) || /(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(extension)) {\n     return true;\n   }\n   if (/^data:/.test(url)) {\n     // other file types of base64\n     return false;\n   }\n   if (extension) {\n     // other file types which have extension\n     return false;\n   }\n   return true;\n };\n exports.isImageUrl = isImageUrl;\n var MEASURE_SIZE = 200;\n function previewImage(file) {\n   return new Promise(function (resolve) {\n     if (!file.type || !isImageFileType(file.type)) {\n       resolve('');\n       return;\n     }\n     var canvas = document.createElement('canvas');\n     canvas.width = MEASURE_SIZE;\n     canvas.height = MEASURE_SIZE;\n     canvas.style.cssText = \"position: fixed; left: 0; top: 0; width: \".concat(MEASURE_SIZE, \"px; height: \").concat(MEASURE_SIZE, \"px; z-index: 9999; display: none;\");\n     document.body.appendChild(canvas);\n     var ctx = canvas.getContext('2d');\n     var img = new Image();\n     img.onload = function () {\n       var width = img.width,\n         height = img.height;\n       var drawWidth = MEASURE_SIZE;\n       var drawHeight = MEASURE_SIZE;\n       var offsetX = 0;\n       var offsetY = 0;\n       if (width > height) {\n         drawHeight = height * (MEASURE_SIZE / width);\n         offsetY = -(drawHeight - drawWidth) / 2;\n       } else {\n         drawWidth = width * (MEASURE_SIZE / height);\n         offsetX = -(drawWidth - drawHeight) / 2;\n       }\n       ctx.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);\n       var dataURL = canvas.toDataURL();\n       document.body.removeChild(canvas);\n       resolve(dataURL);\n     };\n     img.crossOrigin = 'anonymous';\n     if (file.type.startsWith('image/svg+xml')) {\n       var reader = new FileReader();\n       reader.addEventListener('load', function () {\n         if (reader.result) img.src = reader.result;\n       });\n       reader.readAsDataURL(file);\n     } else {\n       img.src = window.URL.createObjectURL(file);\n     }\n   });\n }\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_file2Obj = module.exports.file2Obj;\n_getFileItem = module.exports.getFileItem;\n_isImageUrl = module.exports.isImageUrl;\n_previewImage = module.exports.previewImage;\n_removeFileItem = module.exports.removeFileItem;\n_updateFileList = module.exports.updateFileList;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireDefault': _req,\n  '@babel/runtime/helpers/toConsumableArray': _req0,\n  '@babel/runtime/helpers/extends': _req1,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}