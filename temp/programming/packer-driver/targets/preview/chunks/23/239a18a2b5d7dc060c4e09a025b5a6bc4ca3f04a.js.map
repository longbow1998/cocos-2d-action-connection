{"version":3,"sources":["file:///Users/longbow/node_modules/rc-dropdown/lib/hooks/useAccessibility.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","url","define","exports","require","module","__filename","__dirname","_interopRequireDefault","_interopRequireWildcard","Object","defineProperty","value","default","useAccessibility","React","_KeyCode","_raf","_focus","ESC","TAB","_ref","visible","setTriggerVisible","triggerRef","onVisibleChange","autoFocus","focusMenuRef","useRef","handleCloseMenuAndReturnFocus","current","_triggerRef$current","_triggerRef$current$t","_triggerRef$current$t2","_triggerRef$current$t3","focus","call","focusMenu","_triggerRef$current2","_triggerRef$current2$","_triggerRef$current2$2","_triggerRef$current2$3","elements","getFocusNodeList","popupRef","getElement","firstElement","handleKeyDown","event","keyCode","focusResult","preventDefault","useEffect","window","addEventListener","removeEventListener","_cjsExports","___esModule","__esModule","_default"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/interopRequireWildcard';\nimport { __cjsMetaURL as _req1} from 'react';\nimport { __cjsMetaURL as _req2} from 'rc-util/lib/KeyCode';\nimport { __cjsMetaURL as _req3} from 'rc-util/lib/raf';\nimport { __cjsMetaURL as _req4} from 'rc-util/lib/Dom/focus';\nlet _cjsExports;\nlet ___esModule;\nlet _default;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\n var _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = useAccessibility;\n\n var React = _interopRequireWildcard(require(\"react\"));\n\n var _KeyCode = _interopRequireDefault(require(\"rc-util/lib/KeyCode\"));\n\n var _raf = _interopRequireDefault(require(\"rc-util/lib/raf\"));\n\n var _focus = require(\"rc-util/lib/Dom/focus\");\n\n var ESC = _KeyCode.default.ESC,\n     TAB = _KeyCode.default.TAB;\n\n function useAccessibility(_ref) {\n   var visible = _ref.visible,\n       setTriggerVisible = _ref.setTriggerVisible,\n       triggerRef = _ref.triggerRef,\n       onVisibleChange = _ref.onVisibleChange,\n       autoFocus = _ref.autoFocus;\n   var focusMenuRef = React.useRef(false);\n\n   var handleCloseMenuAndReturnFocus = function handleCloseMenuAndReturnFocus() {\n     if (visible && triggerRef.current) {\n       var _triggerRef$current, _triggerRef$current$t, _triggerRef$current$t2, _triggerRef$current$t3;\n\n       (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$t = _triggerRef$current.triggerRef) === null || _triggerRef$current$t === void 0 ? void 0 : (_triggerRef$current$t2 = _triggerRef$current$t.current) === null || _triggerRef$current$t2 === void 0 ? void 0 : (_triggerRef$current$t3 = _triggerRef$current$t2.focus) === null || _triggerRef$current$t3 === void 0 ? void 0 : _triggerRef$current$t3.call(_triggerRef$current$t2);\n       setTriggerVisible(false);\n\n       if (typeof onVisibleChange === 'function') {\n         onVisibleChange(false);\n       }\n     }\n   };\n\n   var focusMenu = function focusMenu() {\n     var _triggerRef$current2, _triggerRef$current2$, _triggerRef$current2$2, _triggerRef$current2$3;\n\n     var elements = (0, _focus.getFocusNodeList)((_triggerRef$current2 = triggerRef.current) === null || _triggerRef$current2 === void 0 ? void 0 : (_triggerRef$current2$ = _triggerRef$current2.popupRef) === null || _triggerRef$current2$ === void 0 ? void 0 : (_triggerRef$current2$2 = _triggerRef$current2$.current) === null || _triggerRef$current2$2 === void 0 ? void 0 : (_triggerRef$current2$3 = _triggerRef$current2$2.getElement) === null || _triggerRef$current2$3 === void 0 ? void 0 : _triggerRef$current2$3.call(_triggerRef$current2$2));\n     var firstElement = elements[0];\n\n     if (firstElement === null || firstElement === void 0 ? void 0 : firstElement.focus) {\n       firstElement.focus();\n       focusMenuRef.current = true;\n       return true;\n     }\n\n     return false;\n   };\n\n   var handleKeyDown = function handleKeyDown(event) {\n     switch (event.keyCode) {\n       case ESC:\n         handleCloseMenuAndReturnFocus();\n         break;\n\n       case TAB:\n         {\n           var focusResult = false;\n\n           if (!focusMenuRef.current) {\n             focusResult = focusMenu();\n           }\n\n           if (focusResult) {\n             event.preventDefault();\n           } else {\n             handleCloseMenuAndReturnFocus();\n           }\n\n           break;\n         }\n     }\n   };\n\n   React.useEffect(function () {\n     if (visible) {\n       window.addEventListener('keydown', handleKeyDown);\n\n       if (autoFocus) {\n         // FIXME: hack with raf\n         (0, _raf.default)(focusMenu, 3);\n       }\n\n       return function () {\n         window.removeEventListener('keydown', handleKeyDown);\n         focusMenuRef.current = false;\n       };\n     }\n\n     return function () {\n       focusMenuRef.current = false;\n     };\n   }, [visible]); // eslint-disable-line react-hooks/exhaustive-deps\n }\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default = module.exports.default;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireDefault': _req,\n  '@babel/runtime/helpers/interopRequireWildcard': _req0,\n  'react': _req1,\n  'rc-util/lib/KeyCode': _req2,\n  'rc-util/lib/raf': _req3,\n  'rc-util/lib/Dom/focus': _req4,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}