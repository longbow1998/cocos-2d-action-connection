{"version":3,"sources":["file:///Users/longbow/project/learn/%E6%A8%AA%E7%89%88%E6%B8%B8%E6%88%8Fdemo/assets/script/game.ts"],"names":["_decorator","BoxCollider2D","Component","ERigidBody2DType","PhysicsSystem2D","RigidBody2D","TiledMap","v2","ccclass","property","game","start","instance","enable","debugDrawFlags","map","node","getChildByName","tiledMap","getComponent","tiledSize","getTileSize","layer","getLayer","layerSize","getLayerSize","i","width","j","height","tiled","getTiledTileAt","grid","body","addComponent","group","Math","pow","type","Static","collider","offset","size","apply","console","log","update","deltaTime"],"mappings":";;;;;;;;;;AACEA,MAAAA,U,OAAAA,U;AACAC,MAAAA,a,OAAAA,a;AACAC,MAAAA,S,OAAAA,S;AACAC,MAAAA,gB,OAAAA,gB;AACAC,MAAAA,e,OAAAA,e;AACAC,MAAAA,W,OAAAA,W;AACAC,MAAAA,Q,OAAAA,Q;AACAC,MAAAA,E,OAAAA,E;;;;;;;;;OAEI;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;sBAGjBU,I,WADZF,OAAO,CAAC,MAAD,C,gBAAR,MACaE,IADb,SAC0BR,SAD1B,CACoC;AAClCS,QAAAA,KAAK,GAAG;AACNP,UAAAA,eAAe,CAACQ,QAAhB,CAAyBC,MAAzB,GAAkC,IAAlC;AACAT,UAAAA,eAAe,CAACQ,QAAhB,CAAyBE,cAAzB,GAA0C,CAA1C;AACA,cAAIC,GAAG,GAAG,KAAKC,IAAL,CAAUC,cAAV,CAAyB,KAAzB,CAAV;AACA,cAAMC,QAAQ,GAAGH,GAAG,CAACI,YAAJ,CAAiBb,QAAjB,CAAjB;AACA,cAAMc,SAAS,GAAGF,QAAQ,CAACG,WAAT,EAAlB;AACA,cAAMC,KAAK,GAAGJ,QAAQ,CAACK,QAAT,CAAkB,MAAlB,CAAd;AACA,cAAMC,SAAS,GAAGF,KAAK,CAACG,YAAN,EAAlB;;AAEA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,SAAS,CAACG,KAA9B,EAAqCD,CAAC,EAAtC,EAA0C;AACxC,iBAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,SAAS,CAACK,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACzC,kBAAIE,KAAK,GAAGR,KAAK,CAACS,cAAN,CAAqBL,CAArB,EAAwBE,CAAxB,EAA2B,IAA3B,CAAZ;;AACA,kBAAIE,KAAK,CAACE,IAAN,KAAe,CAAnB,EAAsB;AACpB,oBAAIC,IAAI,GAAGH,KAAK,CAACI,YAAN,CAAmB7B,WAAnB,CAAX;AACA4B,gBAAAA,IAAI,CAACE,KAAL,GAAaC,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY,CAAZ,CAAb;AACAJ,gBAAAA,IAAI,CAACK,IAAL,GAAYnC,gBAAgB,CAACoC,MAA7B;AACA,oBAAIC,QAAQ,GAAGV,KAAK,CAACd,IAAN,CAAWkB,YAAX,CAAwBjC,aAAxB,CAAf;AACAuC,gBAAAA,QAAQ,CAACL,KAAT,GAAiBC,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY,CAAZ,CAAjB;AACAG,gBAAAA,QAAQ,CAACC,MAAT,GAAkBlC,EAAE,CAACa,SAAS,CAACO,KAAV,GAAkB,CAAnB,EAAsBP,SAAS,CAACS,MAAV,GAAmB,CAAzC,CAApB;AACAW,gBAAAA,QAAQ,CAACE,IAAT,GAAgBtB,SAAhB;AACAoB,gBAAAA,QAAQ,CAACG,KAAT;AAEAC,gBAAAA,OAAO,CAACC,GAAR,CAAYZ,IAAZ;AACAW,gBAAAA,OAAO,CAACC,GAAR,CAAYL,QAAZ;AACD;AACF;AACF;AACF;;AAEDM,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAAE;;AA9BM,O","sourcesContent":["import {\n  _decorator,\n  BoxCollider2D,\n  Component,\n  ERigidBody2DType,\n  PhysicsSystem2D,\n  RigidBody2D,\n  TiledMap,\n  v2\n} from \"cc\"\nconst { ccclass, property } = _decorator\n\n@ccclass(\"game\")\nexport class game extends Component {\n  start() {\n    PhysicsSystem2D.instance.enable = true\n    PhysicsSystem2D.instance.debugDrawFlags = 1\n    let map = this.node.getChildByName(\"map\")\n    const tiledMap = map.getComponent(TiledMap)\n    const tiledSize = tiledMap.getTileSize()\n    const layer = tiledMap.getLayer(\"wall\")\n    const layerSize = layer.getLayerSize()\n\n    for (let i = 0; i < layerSize.width; i++) {\n      for (let j = 0; j < layerSize.height; j++) {\n        let tiled = layer.getTiledTileAt(i, j, true)\n        if (tiled.grid !== 0) {\n          let body = tiled.addComponent(RigidBody2D)\n          body.group = Math.pow(2, 2)\n          body.type = ERigidBody2DType.Static\n          let collider = tiled.node.addComponent(BoxCollider2D)\n          collider.group = Math.pow(2, 2)\n          collider.offset = v2(tiledSize.width / 2, tiledSize.height / 2)\n          collider.size = tiledSize\n          collider.apply()\n\n          console.log(body)\n          console.log(collider)\n        }\n      }\n    }\n  }\n\n  update(deltaTime: number) {}\n}\n"]}