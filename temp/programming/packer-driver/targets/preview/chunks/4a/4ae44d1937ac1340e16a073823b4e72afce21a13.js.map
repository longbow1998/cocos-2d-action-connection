{"version":3,"sources":["file:///Users/longbow/node_modules/rc-upload/lib/request.js"],"names":["_cjsLoader","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","Object","defineProperty","value","default","upload","getError","option","xhr","msg","concat","method","action","status","err","Error","getBody","text","responseText","response","JSON","parse","e","XMLHttpRequest","onProgress","onprogress","progress","total","percent","loaded","formData","FormData","data","keys","forEach","key","Array","isArray","item","append","file","Blob","filename","name","onerror","error","onError","onload","onSuccess","open","withCredentials","headers","setRequestHeader","h","send","abort","_cjsExports","___esModule","__esModule","_default"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nlet _cjsExports;\nlet ___esModule;\nlet _default;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = upload;\n\n function getError(option, xhr) {\n   var msg = \"cannot \".concat(option.method, \" \").concat(option.action, \" \").concat(xhr.status, \"'\");\n   var err = new Error(msg);\n   err.status = xhr.status;\n   err.method = option.method;\n   err.url = option.action;\n   return err;\n }\n\n function getBody(xhr) {\n   var text = xhr.responseText || xhr.response;\n\n   if (!text) {\n     return text;\n   }\n\n   try {\n     return JSON.parse(text);\n   } catch (e) {\n     return text;\n   }\n }\n\n function upload(option) {\n   // eslint-disable-next-line no-undef\n   var xhr = new XMLHttpRequest();\n\n   if (option.onProgress && xhr.upload) {\n     xhr.upload.onprogress = function progress(e) {\n       if (e.total > 0) {\n         e.percent = e.loaded / e.total * 100;\n       }\n\n       option.onProgress(e);\n     };\n   } // eslint-disable-next-line no-undef\n\n\n   var formData = new FormData();\n\n   if (option.data) {\n     Object.keys(option.data).forEach(function (key) {\n       var value = option.data[key]; // support key-value array data\n\n       if (Array.isArray(value)) {\n         value.forEach(function (item) {\n           // { list: [ 11, 22 ] }\n           // formData.append('list[]', 11);\n           formData.append(\"\".concat(key, \"[]\"), item);\n         });\n         return;\n       }\n\n       formData.append(key, value);\n     });\n   } // eslint-disable-next-line no-undef\n\n\n   if (option.file instanceof Blob) {\n     formData.append(option.filename, option.file, option.file.name);\n   } else {\n     formData.append(option.filename, option.file);\n   }\n\n   xhr.onerror = function error(e) {\n     option.onError(e);\n   };\n\n   xhr.onload = function onload() {\n     // allow success when 2xx status\n     // see https://github.com/react-component/upload/issues/34\n     if (xhr.status < 200 || xhr.status >= 300) {\n       return option.onError(getError(option, xhr), getBody(xhr));\n     }\n\n     return option.onSuccess(getBody(xhr), xhr);\n   };\n\n   xhr.open(option.method, option.action, true); // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179\n\n   if (option.withCredentials && 'withCredentials' in xhr) {\n     xhr.withCredentials = true;\n   }\n\n   var headers = option.headers || {}; // when set headers['X-Requested-With'] = null , can close default XHR header\n   // see https://github.com/react-component/upload/issues/33\n\n   if (headers['X-Requested-With'] !== null) {\n     xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n   }\n\n   Object.keys(headers).forEach(function (h) {\n     if (headers[h] !== null) {\n       xhr.setRequestHeader(h, headers[h]);\n     }\n   });\n   xhr.send(formData);\n   return {\n     abort: function abort() {\n       xhr.abort();\n     }\n   };\n }\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default = module.exports.default;\n\n}, {});\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}