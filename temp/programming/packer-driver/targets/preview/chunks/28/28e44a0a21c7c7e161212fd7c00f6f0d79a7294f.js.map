{"version":3,"sources":["file:///Users/longbow/project/learn/cocos-2d-action-connection/assets/script/hero.ts"],"names":["_decorator","Collider2D","Component","Contact2DType","input","Input","KeyCode","RigidBody2D","v2","ccclass","property","hero","stand","start","on","EventType","KEY_DOWN","event","console","log","keyCode","push","KEY_UP","filter","item","collider","getComponent","BEGIN_CONTACT","onBeginContact","END_CONTACT","onEndContact","contact","selfCollider","otherCollider","action","body","some","x","KEY_W","linearVelocity","add","KEY_A","KEY_D","KEY_S","update","deltaTime","onDestroy","off"],"mappings":"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","sourcesContent":["import {\n  _decorator,\n  BoxCollider2D,\n  Collider,\n  Collider2D,\n  Component,\n  Contact2DType,\n  EventKeyboard,\n  input,\n  Input,\n  KeyCode,\n  Node,\n  RigidBody2D,\n  SystemEvent,\n  v2\n} from \"cc\"\nconst { ccclass, property } = _decorator\n\n@ccclass(\"hero\")\nexport class hero extends Component {\n  @property\n  public keyCode: number[] = []\n  private stand: boolean = false\n\n  start() {\n    input.on(Input.EventType.KEY_DOWN, event => {\n      console.log(event.keyCode)\n      this.keyCode.push(event.keyCode)\n      console.log(this.keyCode)\n    })\n\n    input.on(Input.EventType.KEY_UP, event => {\n      this.keyCode = this.keyCode.filter(item => item !== event.keyCode)\n      console.log(this.keyCode)\n    })\n\n    const collider = this.getComponent(Collider2D)\n    if (collider) {\n      console.log(\"碰撞检测开始\")\n      // 这里没有绑定this的话 回调函数中的this.stand会报错\n      collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this)\n      collider.on(Contact2DType.END_CONTACT, this.onEndContact, this)\n    }\n  }\n\n  onBeginContact(contact, selfCollider, otherCollider) {\n    console.log(\"碰撞开始\")\n    console.log(contact, selfCollider, otherCollider)\n    this.stand = true\n  }\n\n  onEndContact(contact, selfCollider, otherCollider) {\n    console.log(\"碰撞结束\")\n    console.log(contact, selfCollider, otherCollider)\n    this.stand = false\n  }\n\n  action() {\n    const body = this.getComponent(RigidBody2D)\n\n    if (this.keyCode.some(x => x === KeyCode.KEY_W) && this.stand) {\n      console.log(\"跳跃\")\n      body.linearVelocity = body.linearVelocity.add(v2(0, 3))\n    }\n    if (this.keyCode.some(x => x === KeyCode.KEY_A)) {\n      console.log(\"左移\")\n      body.linearVelocity = body.linearVelocity.add(v2(-0.1, 0))\n    }\n    if (this.keyCode.some(x => x === KeyCode.KEY_D)) {\n      console.log(\"右移\")\n      body.linearVelocity = body.linearVelocity.add(v2(0.1, 0))\n    }\n    if (this.keyCode.some(x => x === KeyCode.KEY_S)) {\n    }\n  }\n\n  update(deltaTime: number) {\n    this.action()\n  }\n\n  onDestroy() {\n    input.off(Input.EventType.KEY_DOWN)\n    input.off(Input.EventType.KEY_UP)\n  }\n}\n"]}