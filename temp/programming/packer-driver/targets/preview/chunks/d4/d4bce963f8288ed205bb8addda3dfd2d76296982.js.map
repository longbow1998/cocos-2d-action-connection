{"version":3,"sources":["file:///Users/longbow/node_modules/rc-trigger/lib/Popup/useVisibleStatus.js"],"names":["_cjsLoader","_req","__cjsMetaURL","_req0","_req1","_req2","_req3","_req4","_req5","url","define","exports","require","module","__filename","__dirname","_interopRequireDefault","default","Object","defineProperty","value","_regeneratorRuntime2","_asyncToGenerator2","_slicedToArray2","_react","_raf","_useState3","StatusQueue","_default","visible","doMeasure","_useState","_useState2","status","setInternalStatus","rafRef","useRef","setStatus","nextStatus","cancelRaf","cancel","current","goNextStatus","callback","prev","useEffect","mark","_callee","index","wrap","_callee$","_context","next","indexOf","stop","_cjsExports","___esModule","__esModule","_default0"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '@babel/runtime/helpers/interopRequireDefault';\nimport { __cjsMetaURL as _req0} from '@babel/runtime/helpers/regeneratorRuntime';\nimport { __cjsMetaURL as _req1} from '@babel/runtime/helpers/asyncToGenerator';\nimport { __cjsMetaURL as _req2} from '@babel/runtime/helpers/slicedToArray';\nimport { __cjsMetaURL as _req3} from 'react';\nimport { __cjsMetaURL as _req4} from 'rc-util/lib/raf';\nimport { __cjsMetaURL as _req5} from 'rc-util/lib/hooks/useState';\nlet _cjsExports;\nlet ___esModule;\nlet _default0;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n\n var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n\n Object.defineProperty(exports, \"__esModule\", {\n   value: true\n });\n exports.default = void 0;\n\n var _regeneratorRuntime2 = _interopRequireDefault(require(\"@babel/runtime/helpers/regeneratorRuntime\"));\n\n var _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\n var _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\n var _react = require(\"react\");\n\n var _raf = _interopRequireDefault(require(\"rc-util/lib/raf\"));\n\n var _useState3 = _interopRequireDefault(require(\"rc-util/lib/hooks/useState\"));\n\n var StatusQueue = ['measure', 'alignPre', 'align', null, 'motion'];\n\n var _default = function _default(visible, doMeasure) {\n   var _useState = (0, _useState3.default)(null),\n       _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n       status = _useState2[0],\n       setInternalStatus = _useState2[1];\n\n   var rafRef = (0, _react.useRef)();\n\n   function setStatus(nextStatus) {\n     setInternalStatus(nextStatus, true);\n   }\n\n   function cancelRaf() {\n     _raf.default.cancel(rafRef.current);\n   }\n\n   function goNextStatus(callback) {\n     cancelRaf();\n     rafRef.current = (0, _raf.default)(function () {\n       // Only align should be manually trigger\n       setStatus(function (prev) {\n         switch (status) {\n           case 'align':\n             return 'motion';\n\n           case 'motion':\n             return 'stable';\n\n           default:\n         }\n\n         return prev;\n       });\n       callback === null || callback === void 0 ? void 0 : callback();\n     });\n   } // Init status\n\n\n   (0, _react.useEffect)(function () {\n     setStatus('measure');\n   }, [visible]); // Go next status\n\n   (0, _react.useEffect)(function () {\n     switch (status) {\n       case 'measure':\n         doMeasure();\n         break;\n\n       default:\n     }\n\n     if (status) {\n       rafRef.current = (0, _raf.default)( /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/(0, _regeneratorRuntime2.default)().mark(function _callee() {\n         var index, nextStatus;\n         return (0, _regeneratorRuntime2.default)().wrap(function _callee$(_context) {\n           while (1) {\n             switch (_context.prev = _context.next) {\n               case 0:\n                 index = StatusQueue.indexOf(status);\n                 nextStatus = StatusQueue[index + 1];\n\n                 if (nextStatus && index !== -1) {\n                   setStatus(nextStatus);\n                 }\n\n               case 3:\n               case \"end\":\n                 return _context.stop();\n             }\n           }\n         }, _callee);\n       })));\n     }\n   }, [status]);\n   (0, _react.useEffect)(function () {\n     return function () {\n       cancelRaf();\n     };\n   }, []);\n   return [status, goNextStatus];\n };\n\n exports.default = _default;\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n___esModule = module.exports.__esModule;\n_default0 = module.exports.default;\n\n}, () => ({\n  '@babel/runtime/helpers/interopRequireDefault': _req,\n  '@babel/runtime/helpers/regeneratorRuntime': _req0,\n  '@babel/runtime/helpers/asyncToGenerator': _req1,\n  '@babel/runtime/helpers/slicedToArray': _req2,\n  'react': _req3,\n  'rc-util/lib/raf': _req4,\n  'rc-util/lib/hooks/useState': _req5,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}